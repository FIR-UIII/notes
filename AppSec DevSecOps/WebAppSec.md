# Аутентификация
|#   |Код требования|Условие выполнения|Шаги тестирования|Ожидаемый результат|
|----|--------------|------------------|-----------------|-------------------|
|1   |FAU_GEN.1     |Определить события аудита<br> \nОпределить места хранения|Запустить в терминале команду<br>Проверить фиксацию к журнале события|Журнал аудита фиксирует все события по требованиям|



##### Session Fixation + Session Hijacking
Проверить изменяется ли данные session ID, cookie, JWT после успешной авторизации
Проверить угадываемость / сложность формирования session ID, cookie, JWT
Использование HTTPS для передачи критичных аутентификаторов

##### Authentication Bypass
Insecure "Remember Me" Functionality
CAPTCHA Bypass

# Авторизация

##### Insecure Direct Object References (IDOR)
Прямой доступ к объекту по ссылке из хранилища (БД, S3) без авторизации
Возможность угадывания URL через манипуляцию параметрами (?id=)

# Конфиденциальность
Фронтальный компонент не должен хранить секреты (пароль пользователя)
Использование TLS канала для WS, HTTP, RPT, RPC ...
Проверить HTML/JS на наличие скрытых параметров и аутентификаторов
Не используется хеширование + соль/перец для хранения конфиденциальной информации (пароли пользователей)
На серверной стороне секреты должны храниться в vault провайдере

# Защита сессии и данных (конфиденциальность и целостность)
Использование HTTPS HTTP + TLS. Серверы используют сертификат безопасности Х.509, подписанный центром сертификации, чтобы доказать его подлинность для пользователей.

# Защита от инъекций
##### SQLi
Найти поля возможного пользовательского ввода и URL которые взимодействуют с БД. Найти интеграции с БД.
Должно использоваться ORM, статические запросы, сантизация ввода

##### XXS
Найти поля ввода - вывода пользователя
Санитизация / валидация до отправки на данных сервер, до отображения пользователю и проверки на бэке - не рекомендуется
Выставлена Content Security Policy (CSP)
X-XSS-Protection header
Cookie > Secure; HttpOnly

##### MIME Sniffing
MIME type validation
Content-Type должен быть конко определен + указана кодировка charset UTF-8

##### RCE / Command Injection
Определить где приложение вызывает системные API, функции, десериализация объектов в бинарный формат
Должна быть валидация по белым спискам, сантизация ввода данных
Авторизация запросов (JWT, Cookie, OTP)

##### XML Injection
Определить принимает и парсит ли приложение XML объекты
Запретить / санитизировать парсеру `DTD`, `ENTITY`, `CDATA`, `<script>`

##### Server-Side Request Forgery (SSRF)
Проверить какие запросы проксируются
Манипуляция Origin, Host, X-Fofward, добавление в URL доп.ресурс

##### CSRF / Clickjacking
Определить критичные действия пользователя (смена пароля, отправка ден.переводов, удаление данных и проч.)
Метод доступа должен быть строго ограничен - GET / POST и тп.
Данные действия должны иметь дополнительный одноразовый токен (CSRF token)
Проверка Origin / Host на соответсвие ожидаемой сессии пользователя
Cookie > SameSite
X-Frame-Options > 

##### HTML Injection
Валидация и санитизация HTML данных от недоверенных источников `<h><a href=https://bing.com>malicious link</a></h>`
Проверить политики CORS

##### File Inclusion Vulnerabilities
Валидация загружаемых файлов

##### Server-Side Includes / SSTI
TBA 

##### 

##### Brute Force Attack
Провести fuzzing ввода критичных параметров (логин/пароль, ID объектов для доступа)

# Ошибки конфигурирования
Проверить на соответствие HTTP заголовки, передаваемые на фронт (CORS, Cookie, Content-Type)
Проверить на ошибки конфигурироваться прокси и компоненты системы (NGINX, Redis, S3, PostgreSQL, HAproxy ...)

##### Защита от атак с понижением до HTTP
Использование заголовка HSТS - принуждает браузеры к использованию НТТРS. Strict-`Transport-Security: max-age=31536000; includeSubDomains; preload`
	НSТS-заголовок содержит три параметра:
	max-age - указывает продолжительность в секундах существования информации в кэше браузера.
	includeSubDomains - командует браузеру подключаться через НТТРS к данному домену и всем его поддоменам.
	preload - указывает на желание администраторов добавить их сайт в список предварительной загрузки HSTS. 
	
##### Защита от недоверенных центров сертификации 
Использование заголовка НРКР, отправляемый браузерам и заносимый в кэш на заданный период времени. Заголовок содержит хеши сертификатов, допускаемых до защиты сайта. 
`PuЬlic-Key-Pins: max-age=1296000; includeSubDomains;                                            pin-sha256="VLh1dUR9y6Kja30RrAn7JКnЬQG/uEtLMkBgFF2Fu1hg=";                                pin-sha256="++МBgDHSWGvL9Bcn5Be30cRcL0fSO+NyoXuWtQdX1aI="`
	max-age - указывает продолжительность в секундах существования информации в кэше браузера.
	pin-sha256 - это Ваsе64-хеш открытого ключа для сертификата, которому доверяет данный сайт. 
	includeSubDomains указывает, что все поддомены текущего домена должны применять политику НРКР.
	report-uri - это необязательная конечная точка, на которую браузеры должны отправлять оповещения о нарушении политики. Не все браузеры поддерживают эту функцию.

##### Unprotected API Endpoints
Проверсти fuzzing API и выявить API старых версий, подверженных BOLA, BFLA, без ограничений на методы (OPTIONS, PUT) и тп. см OWAST API TOP-10

##### Unpatched Software
Проверять и патчить версии софта

##### HTML5 Security Issues
Review HTML5 features and functionalities used in web applications
Test for vulnerabilities associated with HTML5 features, such as XSS or CSRF.

##### Resource Exhaustion
Проверить ограничения и своевременную очистку логов, временных файлоа, лимитов на память и пр.
