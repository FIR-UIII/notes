### ОНД:
ФСТЭК России «Профили защиты операционных систем»
ГОСТ Р ИСО/МЭК 15408 «Информационная технология (ИТ). Методы и средства обеспечения безопасности. Критерии оценки безопасности информационных технологий».

### Меры безопасности ОС:
##### Идентификация, аутентификация и авторизация пользователей
	Идентификация ‒ предоставление пользователем своих логина и пароля 
	Аутентификация ‒ процедура проверки идентификационных данных, предоставленных пользователем при входе в ИС (NTLM, Kerberos, RADIUS, HTTP Authorzation)
	Авторизация ‒ проверка наличия у пользователя прав на выполнение некоторых действий.
Технические меры: логин/пароль, OTP (СМС, приложение), USB-токен, биометрия, SSO, IAM/PAM
Организационные меры: Парольная политика, Модели управления доступом
![[Pasted image 20240106135234.png]]
##### Обеспечение целостности системных ресурсов
контроль целостности компонентов ПО
возможность тестирования (самотестирования) функций безопасности ОС
возможность восстановления штатного режима функционирования ОС
возможность возврата ОС при сбоях и отказах к безопасному состоянию в автоматизированном режиме
возможность восстановления объектов ОС из резервных копий
Технические меры: Безопасная и доверенная загрузка ОС / UEFI Secure Boot, Доверенный платформенный модуль (Соболь)

##### Обеспечение безопасности системных вызовов
WinAPI, syscall,
##### Журналирование файловых систем

##### Криптографическая защита
PKI, 

### Система безопасности ОС Windows
* Монитор безопасности (%System Root%\System32\Ntoskrnl.exe) - отвечает за доступ и права пользователей
* Local Security Authority Subsystem, LSASS (%SystemRoot%\System32\Lsass.exe) - отвечает за политику безопасности локальной системы, аутентификацию пользователя и отправку сообщений проверки безопасности журналу событий (Event Log)
* База данных политики LSASS - хранит секреты (пароли) HKLM\SECURITY
* Администратор учетных данных в системе защиты SAM (%SystemRoot%\ System32\Samsrv.dll, загружается в процесс LSASS) - служба, отвечающая за управление базой данных LSASS
* База данных SAM - содержит определения локальных пользователей и групп наряду с их паролями и другими атрибутами. Эта база данных хранится в реестре в разделе HKLM\SAM
* Интерактивный диспетчер входа в систему (Winlogon) (%SystemRoot%\System32\Winlogon.exe) - процесс отвечающий за реагирование на SAS и за управление интерактивными сеансами входа в систему
* Служба входа в сеть (%SystemRoot%\System32\Netlogon.dll) - устанавливает безопасный канал к контроллеру домена
* Драйвер устройства безопасности ядра (KSecDD) (%SystemRoot%\System32\Drivers\Ksecdd.sys)
* AppLocker – механизм, позволяющий администраторам определять, какие исполняемые файлы, DLL-библиотеки и сценарии могут использоваться конкретными пользователями и группами. AppLocker состоит из драйвера (%SystemRoot%\System32\Drivers\AppId.sys) и службы (%System Root%\System32\AppIdSvc.dll), выполняемой в процессе SvcHost.

Привилегии:
‒ SeBackupPrivilege (на создание резервной копии); 
‒ SeCreateTokenPrivilege (на создание маркера); 
‒ SeDebugPrivilege (на отладку); 
‒ SeImpersonatePrivilege (на работу от имени других пользователей); 
‒ SeLabelPrivilege (на создание меток); 
‒ SeLoadDriverPrivilege (на загрузку драйверов); 
‒ SeRestorePrivilege (на восстановление системы); 
‒ SeTakeOwnershipPrivilege (на смену владельца); 
‒ SeTcbPrivilege (на работу с блоком управления потоком).

### Система безопасности ОС UNUX
##### Аутентификация в UNIX. 
Список пользователей UNIX хранится в текстовом файле `/etc/passwd` Пароли пользователей в `/etc/shadow либо` в `/etc/tcb/<username>/shadow` Пример строки:
`root:х:0:0:System Administrator:/root:/bin/bash`, где 
	root - имя пользователя
	x - признак того, что хэш-образ пароля хранится в отдельном файле
	0 - UID пользователя
	0 - GID первичной группы пользователя
	System Administrator - комментарий к учетной записи
	/root - домашняя директория
	/bin/bash - командный интерпретатор

##### Pluggable Authentication Module (РАМ) - дополнительная подсистема аутентификации.
Нужно доработать
##### Сетевая защита
netfilter
utw
iptables

##### Управление доступом 
chmod
SELinux
sudo (/etc/sudoers) root ALL = NOPASSWD: ALL

##### Аудит в UNIX
syslogd - предоставляет услуги прикладным и системным программам. Политика доступа через /etc/syslog.conf
klogd - аудит операций, выполняемых ядром ОС
auditd - регистрация событий, реализуемый демонами syslogd и klogd

В большинстве UNIX-систем большая часть сообщений аудита традиционно записывается в файл /var/log/messages или /var/adm/log/messages. Для хранения сообщений о попытках аутентификации традиционно используется файл /var/log/auth.log или /var/adm/loginlog.

##### Подсистема контроля целостности
В Linux системах возможна проверка целостности установленных в
системе пакетов. Это позволяет убедиться в том, что файлы, установленные из пакета, не были изменены после инсталляции.
```
rpm --verify --all
```