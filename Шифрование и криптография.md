### Хеширование
Концепт: Мясорубка. Шифрует один – дешифрует никто.
Проверка целостности – каждый файл имеет уникальный хеш.
SHA2: SHA-224, SHA-256, SHA-384 и SHA-512 (неустойчива к атакам удлинением сообщения)
SHA3: SHA-3-224, SHA-3-256, SHA-3-384 и SHA-3-512.
cSHAKE
```
sha256sum
echo -n "привет" | openssl dgst -sha256
echo -n "Алиса""Боб""100""15" | openssl dgst -sha3-256
cSHAKE(input="hello world", output_length=256, custom_string="мой_хеш")
```

### Симметричное шифрование
Концепт: Один секрет, шифрует один – проверяет один.
Шифрование ключом ---отправка---> Дешифрование ключом
Протоколы:
Блочный:
AES (угадываемый)
AES + CBC (не проверяется целостность блоков)
AES-CBC-HMAC (проверяется целостность блоков)
AES-GCM (аутентифицированное шифрование)
AES–CCM
POLY1305 (Без аппаратной поддержки)
Потоковые:
CHACHA20

### Ассимметричное шифрование
Концепт: Шифруют все – проверяет один
DH способ обмена ключами, через сессионый ключ (общий секрет)
Шифрование открытым ключом ---отправка---> дешифрование закрытым ключом
Протоколы: RSA

### Цифровая подпись
Концепт: Шифрует один – проверяют все
Подписание (шифрование) закрытым ключом ---отправка---> проверка целостности (дешифрование) открытым ключом
Протоколы: RSA

### Имитовставки
Концепт: хеш + ключ (секрет), подписание сообщения
Cookie c nonce, state, хеш с солью\перцем, MAC, HMAC, аутентификатор с тегом
Верно - SHA-256(секрет || входные_данные) или SHA-256(секрет || сообщение || секрет).
Неверно - SHA-256(входные_данные)Обмен ключами Диффи - Хеппмана (DH) - протокол (способ) обмена ключами открытый - закрытый
Алгоритм RSA - обмен шифрованными сообщениями с помощью пары ключей (открытый закрытый) и механизм подписания документов
Шифрование сообщений:
		1. А отправляет свой открытый ключ Б
		2. Б шифрует сообщение отрытым ключом и отправляет А
		3. А получаем сообщение и дешифрует его закрытым ключом
Подписание:
		1. А вычисляет хеш документа и подписываем закрытым ключом документ
		2. Б получает документ с подписью и дешифрует открытым ключом хеш в подписи и вычисляет хеш документа
		3. Б сравнивает хеши - если совпали - то подпись подлинная
PKI - подписание открытого ключа - закрытым ключом центром сертификации (доверенное лицо)

### TLS / SSL
Проверить TLS соединение с сайтом google.com по порту 443
```
$ openssl s_client -connect google.com:443

# Цепочка доверия от 0 до 2 - корневой сертификат
Certificate chain 
0 s:/C=US/ST=California/L=Mountain View/O=Google Inc/CN=*.google.com 
  i:/C=US/O=Google Inc/CN=Google Internet Authority G2
1 s:/C=US/O=Google Inc/CN=Google Internet Authority G2 
  i:/C=US/O=GeoTrust Inc./CN=GeoTrust Global СА
2 s:/C=US/O=GeoTrust Inc./CN=GeoTrust Global СА 
  i:/C=US/O=Equifax/OU=Equifax Secure Certificate Authority

Server certificate
-----BEGIN CERTIFICATE-----
...

SSL-Session: Protocol : TLSvl.2 # версия протокола
Cipher : ECDHE-RSA-AES128-GCM-SHA256 # стек протоколов шифрования
Session-ID: 0871Е6F1А35АЕ705...
Session-ID-ctx: Master-Key: 01F2462FD1D61 ... 
Key-Arg : None 1
PSK identity: None 
PSK identity hint: None 
SRP username: None 
TLS session ticket lifetime hint: 100800 (seconds) 
TLS session ticket:
0000 - d7 2а 55 df . . . . . .
```

Алгоритм построения канала
![[ssl_test.pcap]]
![[Pasted image 20240103145949.png]]
##### mTLS - взаимный / mutual TLS
![[Pasted image 20240103145956.png]]
